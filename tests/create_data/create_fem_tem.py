"""Create data for test_fem and test_tem."""
import numpy as np
from copy import deepcopy
from empymod import filters
from empymod.model import fem, tem

# # A -- FEM # #

# Model
# res = [3, 10, 3]
# aniso = [1, 2, 3]
# mpermH = [1, 5, 10]
# mpermV = [2, 5, 5]
# epermH = [1, 80, 50]
# epermV = [1, 80, 80]
depth = np.array([-np.inf, 0., 500.])
etaH = np.array([[0.33333333 + 5.56325028e-12j, 0.10000000 + 4.45060022e-10j,
                  0.33333333 + 2.78162514e-10j],
                 [0.33333333 + 5.56325028e-11j, 0.10000000 + 4.45060022e-09j,
                  0.33333333 + 2.78162514e-09j],
                 [0.33333333 + 5.56325028e-10j, 0.10000000 + 4.45060022e-08j,
                  0.33333333 + 2.78162514e-08j]])
etaV = np.array([[0.33333333 + 5.56325028e-12j, 0.02500000 + 4.45060022e-10j,
                  0.03703704 + 4.45060022e-10j],
                 [0.33333333 + 5.56325028e-11j, 0.02500000 + 4.45060022e-09j,
                  0.03703704 + 4.45060022e-09j],
                 [0.33333333 + 5.56325028e-10j, 0.02500000 + 4.45060022e-08j,
                  0.03703704 + 4.45060022e-08j]])
zetaH = np.array([[0. + 7.89568352e-07j, 0. + 3.94784176e-06j,
                   0. + 7.89568352e-06j],
                  [0. + 7.89568352e-06j, 0. + 3.94784176e-05j,
                   0. + 7.89568352e-05j],
                  [0. + 7.89568352e-05j, 0. + 3.94784176e-04j,
                   0. + 7.89568352e-04j]])
zetaV = np.array([[0. + 1.57913670e-06j, 0. + 3.94784176e-06j,
                   0. + 3.94784176e-06j],
                  [0. + 1.57913670e-05j, 0. + 3.94784176e-05j,
                   0. + 3.94784176e-05j],
                  [0. + 1.57913670e-04j, 0. + 3.94784176e-04j,
                   0. + 3.94784176e-04j]])
freq = np.array([0.1, 1., 10.])

# src and rec
# rec = [np.arange(1,11)*500, np.arange(1,11)*100, 300]
# src = [[0, -100], [0, -200], 200]
nsrc = 2
nrec = 10
off = np.array([509.90195136, 1019.80390272, 1529.70585408, 2039.60780544,
                2549.5097568, 3059.41170816, 3569.31365951, 4079.21561087,
                4589.11756223, 5099.01951359, 670.82039325, 1170.46999107,
                1676.30546142, 2184.03296678, 2692.58240357, 3201.56211872,
                3710.79506306, 4220.1895692, 4729.69343615, 5239.27475897])
angle = np.array([0.19739556, 0.19739556, 0.19739556, 0.19739556, 0.19739556,
                  0.19739556, 0.19739556, 0.19739556, 0.19739556, 0.19739556,
                  0.46364761, 0.348771, 0.30288487, 0.27829966, 0.26299473,
                  0.25255428, 0.24497866, 0.2392316, 0.23472261, 0.23109067])
lsrc = np.array(1)
lrec = np.array(1)
zsrc = np.array([200])
zrec = np.array([300])

# 1. FULLSPACE
inp1 = {'ab': 12,
        'off': off,
        'angle': angle,
        'zsrc': zsrc,
        'zrec': zrec,
        'lsrc': lsrc,
        'lrec': lrec,
        'depth': depth,
        'freq': freq,
        'etaH': np.ones((3, 3))*etaH[:, 0],
        'etaV': np.ones((3, 3))*etaV[:, 0],
        'zetaH': np.ones((3, 3))*zetaH[:, 0],
        'zetaV': np.ones((3, 3))*zetaV[:, 0],
        'xdirect': True,
        'isfullspace': True,
        'ht': 'fht',
        'htarg': (filters.key_401_2009(), None),
        'use_spline': False,
        'use_ne_eval': False,
        'msrc': True,
        'mrec': True,
        'loop_freq': False,
        'loop_off': False}

EM1, kcount1, _ = fem(**inp1)

# 2. NORMAL CASE
inp2 = deepcopy(inp1)
inp2['etaH'] = etaH
inp2['etaV'] = etaV
inp2['zetaH'] = zetaH
inp2['zetaV'] = zetaV
inp2['isfullspace'] = False
inp2['msrc'] = False
inp2['mrec'] = False

EM2, kcount2, _ = fem(**inp2)

# 3. NORMAL CASE; loop_freq
inp3 = deepcopy(inp2)
inp3['loop_freq'] = True
EM3, kcount3, _ = fem(**inp3)

# 4. NORMAL CASE; loop_off
inp4 = deepcopy(inp2)
inp4['loop_off'] = True
EM4, kcount4, _ = fem(**inp4)

# 5. 36/63
inp5 = deepcopy(inp2)
inp5['ab'] = 36
inp5['msrc'] = True
EM5, kcount5, _ = fem(**inp5)

# # B -- TEM # #
# Same parameters as for fem, except frequency, time, ab; plus signal

# ab = 22

freq = np.array([6.06248808e-04, 7.91689600e-04, 1.03385345e-03,
                 1.35009094e-03, 1.76305989e-03, 2.30234874e-03,
                 3.00659651e-03, 3.92626122e-03, 5.12723511e-03,
                 6.69556567e-03, 8.74362083e-03, 1.14181398e-02,
                 1.49107469e-02, 1.94716808e-02, 2.54277237e-02,
                 3.32056148e-02, 4.33626252e-02, 5.66264856e-02,
                 7.39475263e-02, 9.65667672e-02, 1.26104834e-01,
                 1.64678073e-01, 2.15050184e-01, 2.80830233e-01,
                 3.66731236e-01, 4.78907836e-01, 6.25397276e-01,
                 8.16695245e-01, 1.06650788e+00, 1.39273378e+00])

ftarg = (np.array(10), np.array([-2., 1.]), np.array(0.0),
         np.array([1.06702733e-01, 1.39341213e-01, 1.81963226e-01,
                   2.37622560e-01, 3.10307099e-01, 4.05224554e-01,
                   5.29175581e-01, 6.91041035e-01, 9.02418269e-01,
                   1.17845206e+00, 1.53891971e+00, 2.00964804e+00,
                   2.62436385e+00, 3.42711034e+00, 4.47540280e+00,
                   5.84434939e+00, 7.63203254e+00, 9.96653635e+00,
                   1.30151236e+01, 1.69962198e+01, 2.21950629e+01,
                   2.89841402e+01, 3.78498763e+01, 4.94274842e+01,
                   6.45464777e+01, 8.42901040e+01, 1.10072957e+02,
                   1.43742328e+02, 1.87710564e+02, 2.45127907e+02]),
         0.26687891892167492, 0.93373475300097497, 0.05607575105408464,
         np.array(0.0))

fEM = np.array([[-7.58011581e-09 - 6.33717380e-13j,
                 -7.52395949e-10 - 2.75634277e-13j,
                 -1.60463739e-10 - 1.77238175e-13j,
                 -5.44002706e-11 - 1.28146858e-13j,
                 -2.46346027e-11 - 9.84676709e-14j,
                 -1.33089881e-11 - 7.86157424e-14j,
                 -8.04334542e-12 - 6.44185515e-14j,
                 -5.24720840e-12 - 5.37674693e-14j,
                 -3.61895938e-12 - 4.54865171e-14j,
                 -2.60449429e-12 - 3.88693049e-14j,
                 -1.33302751e-09 - 7.06969617e-13j,
                 -2.93284534e-10 - 2.98679924e-13j,
                 -8.75479109e-11 - 1.83992265e-13j,
                 -3.58307554e-11 - 1.30632167e-13j,
                 -1.80712815e-11 - 9.95830068e-14j,
                 -1.04153878e-11 - 7.91934708e-14j,
                 -6.56454989e-12 - 6.47492636e-14j,
                 -4.41028609e-12 - 5.39712017e-14j,
                 -3.10890129e-12 - 4.56197330e-14j,
                 -2.27563736e-12 - 3.89612261e-14j],
                [-7.58012684e-09 - 8.23286050e-13j,
                 -7.52406507e-10 - 3.55681819e-13j,
                 -1.60473844e-10 - 2.27204538e-13j,
                 -5.44099419e-11 - 1.63119400e-13j,
                 -2.46438582e-11 - 1.24389747e-13j,
                 -1.33178426e-11 - 9.84985156e-14j,
                 -8.05181202e-12 - 7.99965510e-14j,
                 -5.25529930e-12 - 6.61299123e-14j,
                 -3.62668610e-12 - 5.53626026e-14j,
                 -2.61186790e-12 - 4.67718646e-14j,
                 -1.33303844e-09 - 9.18946725e-13j,
                 -2.93294995e-10 - 3.85780038e-13j,
                 -8.75579235e-11 - 2.36029249e-13j,
                 -3.58403394e-11 - 1.66370846e-13j,
                 -1.80804534e-11 - 1.25853345e-13j,
                 -1.04241618e-11 - 9.92611592e-14j,
                 -6.57293872e-12 - 8.04376419e-14j,
                 -4.41830187e-12 - 6.64061316e-14j,
                 -3.11655541e-12 - 5.55476148e-14j,
                 -2.28294078e-12 - 4.69037626e-14j],
                [-7.58014326e-09 - 1.06872905e-12j,
                 -7.52422112e-10 - 4.58112714e-13j,
                 -1.60488681e-10 - 2.90368357e-13j,
                 -5.44240499e-11 - 2.06723792e-13j,
                 -2.46572683e-11 - 1.56200926e-13j,
                 -1.33305821e-11 - 1.22453186e-13j,
                 -8.06390575e-12 - 9.83638907e-14j,
                 -5.26677035e-12 - 8.03360265e-14j,
                 -3.63755634e-12 - 6.63631019e-14j,
                 -2.62215830e-12 - 5.52394730e-14j,
                 -1.33305468e-09 - 1.19365429e-12j,
                 -2.93310435e-10 - 4.97423878e-13j,
                 -8.75726066e-11 - 3.01901395e-13j,
                 -3.58543009e-11 - 2.10981178e-13j,
                 -1.80937236e-11 - 1.58125790e-13j,
                 -1.04367672e-11 - 1.23464710e-13j,
                 -6.58490376e-12 - 9.89573643e-14j,
                 -4.42964923e-12 - 8.07159007e-14j,
                 -3.12730673e-12 - 6.66254244e-14j,
                 -2.29311687e-12 - 5.54338462e-14j],
                [-7.58016767e-09 - 1.38609348e-12j,
                 -7.52445141e-10 - 5.88738792e-13j,
                 -1.60510413e-10 - 3.69746004e-13j,
                 -5.44445543e-11 - 2.60598952e-13j,
                 -2.46766040e-11 - 1.94724473e-13j,
                 -1.33488004e-11 - 1.50774202e-13j,
                 -8.08105338e-12 - 1.19453021e-13j,
                 -5.28289095e-12 - 9.60621655e-14j,
                 -3.65269136e-12 - 7.79799822e-14j,
                 -2.63634753e-12 - 6.36307022e-14j,
                 -1.33307878e-09 - 1.54923824e-12j,
                 -2.93333185e-10 - 6.40087002e-13j,
                 -8.75940784e-11 - 3.84824139e-13j,
                 -3.58745601e-11 - 2.66180406e-13j,
                 -1.81128263e-11 - 1.97263996e-13j,
                 -1.04547636e-11 - 1.52124703e-13j,
                 -6.60183950e-12 - 1.20260939e-13j,
                 -4.44556741e-12 - 9.65941541e-14j,
                 -3.14224838e-12 - 7.83611513e-14j,
                 -2.30712142e-12 - 6.39255260e-14j],
                [-7.58020392e-09 - 1.79581845e-12j,
                 -7.52479062e-10 - 7.54641610e-13j,
                 -1.60542146e-10 - 4.68781757e-13j,
                 -5.44742269e-11 - 3.26407734e-13j,
                 -2.47043254e-11 - 2.40578951e-13j,
                 -1.33746670e-11 - 1.83413345e-13j,
                 -8.10515328e-12 - 1.42769200e-13j,
                 -5.30530669e-12 - 1.12507301e-13j,
                 -3.67350141e-12 - 8.92010830e-14j,
                 -2.65562710e-12 - 7.07899576e-14j,
                 -1.33311452e-09 - 2.00888014e-12j,
                 -2.93366636e-10 - 8.21720419e-13j,
                 -8.76253746e-11 - 4.88505371e-13j,
                 -3.59038234e-11 - 3.33738126e-13j,
                 -1.81401615e-11 - 2.43944401e-13j,
                 -1.04802645e-11 - 1.85232729e-13j,
                 -6.62559269e-12 - 1.43885935e-13j,
                 -4.46765436e-12 - 1.13268894e-13j,
                 -3.16274672e-12 - 8.97702457e-14j,
                 -2.32610568e-12 - 7.12502584e-14j],
                [-7.58025773e-09 - 2.32382303e-12j,
                 -7.52528920e-10 - 9.64313194e-13j,
                 -1.60588318e-10 - 5.91243165e-13j,
                 -5.45169497e-11 - 4.05624272e-13j,
                 -2.47438023e-11 - 2.93913897e-13j,
                 -1.34110789e-11 - 2.19693539e-13j,
                 -8.13866652e-12 - 1.67100296e-13j,
                 -5.33607725e-12 - 1.28110319e-13j,
                 -3.70167744e-12 - 9.82426191e-14j,
                 -2.68135029e-12 - 7.48004469e-14j,
                 -1.33316746e-09 - 2.60208339e-12j,
                 -2.93415700e-10 - 1.05195674e-12j,
                 -8.76708155e-11 - 6.17063830e-13j,
                 -3.59458653e-11 - 4.15276248e-13j,
                 -1.81790007e-11 - 2.98401656e-13j,
                 -1.05160774e-11 - 2.22174121e-13j,
                 -6.65854281e-12 - 1.68673494e-13j,
                 -4.49789560e-12 - 1.29228442e-13j,
                 -3.19042559e-12 - 9.91167588e-14j,
                 -2.35136249e-12 - 7.55384428e-14j],
                [-7.58033751e-09 - 3.00280066e-12j,
                 -7.52602016e-10 - 1.22772091e-12j,
                 -1.60655219e-10 - 7.40976420e-13j,
                 -5.45780940e-11 - 4.99161908e-13j,
                 -2.47995694e-11 - 3.53985756e-13j,
                 -1.34618090e-11 - 2.57872909e-13j,
                 -8.18467323e-12 - 1.90092851e-13j,
                 -5.37765459e-12 - 1.40153164e-13j,
                 -3.73910401e-12 - 1.02189114e-13j,
                 -2.71489151e-12 - 7.26670201e-14j,
                 -1.33324576e-09 - 3.36622812e-12j,
                 -2.93487461e-10 - 1.34226273e-12j,
                 -8.77364962e-11 - 7.74817450e-13j,
                 -3.60058823e-11 - 5.11916736e-13j,
                 -1.82337211e-11 - 3.60020905e-13j,
                 -1.05658337e-11 - 2.61307412e-13j,
                 -6.70364317e-12 - 1.92359521e-13j,
                 -4.53863008e-12 - 1.41839551e-13j,
                 -3.22706951e-12 - 1.03568019e-13j,
                 -2.38417837e-12 - 7.38766552e-14j],
                [-7.58045565e-09 - 3.87372137e-12j,
                 -7.52708867e-10 - 1.55621799e-12j,
                 -1.60751682e-10 - 9.21433256e-13j,
                 -5.46649819e-11 - 6.06758800e-13j,
                 -2.48775934e-11 - 4.18503622e-13j,
                 -1.35316093e-11 - 2.94504461e-13j,
                 -8.24683974e-12 - 2.07657144e-13j,
                 -5.43273954e-12 - 1.44230224e-13j,
                 -3.78762844e-12 - 9.65381967e-14j,
                 -2.75734897e-12 - 5.99421864e-14j,
                 -1.33336139e-09 - 4.34841607e-12j,
                 -2.93592072e-10 - 1.70596858e-12j,
                 -8.78309281e-11 - 9.65858694e-13j,
                 -3.60909125e-11 - 6.23699160e-13j,
                 -1.83100388e-11 - 4.26711281e-13j,
                 -1.06340644e-11 - 2.99350592e-13j,
                 -6.76436681e-12 - 2.11005768e-13j,
                 -4.59239085e-12 - 1.46842214e-13j,
                 -3.27438162e-12 - 9.87640282e-14j,
                 -2.42552925e-12 - 6.19571529e-14j],
                [-7.58063035e-09 - 4.98751339e-12j,
                 -7.52864521e-10 - 1.96217317e-12j,
                 -1.60889965e-10 - 1.13483809e-12j,
                 -5.47874069e-11 - 7.26006517e-13j,
                 -2.49854942e-11 - 4.82655723e-13j,
                 -1.36261881e-11 - 3.23531818e-13j,
                 -8.32920336e-12 - 2.13171978e-13j,
                 -5.50391954e-12 - 1.33583797e-13j,
                 -3.84859186e-12 - 7.46767773e-14j,
                 -2.80900466e-12 - 3.03450689e-14j,
                 -1.33353186e-09 - 5.60760485e-12j,
                 -2.93743974e-10 - 2.15806062e-12j,
                 -8.79658449e-11 - 1.19329480e-12j,
                 -3.62102955e-11 - 7.48661853e-13j,
                 -1.84151807e-11 - 4.93979756e-13j,
                 -1.07261407e-11 - 3.30522350e-13j,
                 -6.84446436e-12 - 2.18248657e-13j,
                 -4.66152491e-12 - 1.37727318e-13j,
                 -3.33350494e-12 - 7.83333978e-14j,
                 -2.47553748e-12 - 3.37336625e-14j],
                [-7.58088825e-09 - 6.40684304e-12j,
                 -7.53090351e-10 - 2.45812155e-12j,
                 -1.61086838e-10 - 1.38080615e-12j,
                 -5.49581509e-11 - 8.50870275e-13j,
                 -2.51326080e-11 - 5.37714327e-13j,
                 -1.37519249e-11 - 3.35070737e-13j,
                 -8.43562957e-12 - 1.96489133e-13j,
                 -5.59294762e-12 - 9.83509064e-14j,
                 -3.92199891e-12 - 2.73722617e-14j,
                 -2.86844308e-12 + 2.45126495e-14j,
                 -1.33378262e-09 - 7.21698866e-12j,
                 -2.93963540e-10 - 2.71456019e-12j,
                 -8.81571693e-11 - 1.45797936e-12j,
                 -3.63760943e-11 - 8.81449859e-13j,
                 -1.85578790e-11 - 5.53616728e-13j,
                 -1.08479399e-11 - 3.45400513e-13j,
                 -6.94739101e-12 - 2.04376622e-13j,
                 -4.74745769e-12 - 1.05051242e-13j,
                 -3.40419051e-12 - 3.34462188e-14j,
                 -2.53259985e-12 + 1.87979897e-14j],
                [-7.58126822e-09 - 8.20782294e-12j,
                 -7.53416432e-10 - 3.05513496e-12j,
                 -1.61364839e-10 - 1.65414913e-12j,
                 -5.51933581e-11 - 9.69514301e-13j,
                 -2.53296993e-11 - 5.69121330e-13j,
                 -1.39151065e-11 - 3.13866058e-13j,
                 -8.56873254e-12 - 1.42805565e-13j,
                 -5.69948348e-12 - 2.48543595e-14j,
                 -4.00519117e-12 + 5.75394866e-14j,
                 -2.93124749e-12 + 1.15080162e-13j,
                 -1.33415056e-09 - 9.26650967e-12j,
                 -2.94279201e-10 - 3.39121927e-12j,
                 -8.84260771e-11 - 1.75649813e-12j,
                 -3.66033336e-11 - 1.01128768e-12j,
                 -1.87479894e-11 - 5.91917765e-13j,
                 -1.10050263e-11 - 3.29506302e-13j,
                 -7.07520279e-12 - 1.55319107e-13j,
                 -4.84943506e-12 - 3.58311529e-14j,
                 -3.48349189e-12 + 4.74079332e-14j,
                 -2.59212008e-12 + 1.05478427e-13j],
                [-7.58182676e-09 - 1.04813340e-11j,
                 -7.53884624e-10 - 3.75996371e-12j,
                 -1.61753564e-10 - 1.94151734e-12j,
                 -5.55125013e-11 - 1.06122736e-12j,
                 -2.55879975e-11 - 5.54002237e-13j,
                 -1.41203661e-11 - 2.37510386e-13j,
                 -8.72799160e-12 - 3.16024826e-14j,
                 -5.81910664e-12 + 1.04781422e-13j,
                 -4.09092871e-12 + 1.94940689e-13j,
                 -2.98827746e-12 + 2.53155442e-13j,
                 -1.33468887e-09 - 1.18652639e-11j,
                 -2.94730132e-10 - 4.20113799e-12j,
                 -8.88000065e-11 - 2.07810295e-12j,
                 -3.69097774e-11 - 1.11915211e-12j,
                 -1.89954183e-11 - 5.87423572e-13j,
                 -1.12010433e-11 - 2.61727540e-13j,
                 -7.22667596e-12 - 5.17648475e-14j,
                 -4.96257795e-12 + 8.66885522e-14j,
                 -3.56391597e-12 + 1.78086257e-13j,
                 -2.64487412e-12 + 2.37182883e-13j],
                [-7.58264556e-09 - 1.33334182e-11j,
                 -7.54552393e-10 - 4.57030322e-12j,
                 -1.62290705e-10 - 2.21643942e-12j,
                 -5.59374906e-11 - 1.09227161e-12j,
                 -2.59170813e-11 - 4.58180987e-13j,
                 -1.43679165e-11 - 7.47009335e-14j,
                 -8.90678127e-12 + 1.63929002e-13j,
                 -5.94048180e-12 + 3.12192016e-13j,
                 -4.16492989e-12 + 4.01178994e-13j,
                 -3.02373742e-12 + 4.50032277e-13j,
                 -1.33547372e-09 - 1.51433752e-11j,
                 -2.95369458e-10 - 5.15074422e-12j,
                 -8.93132857e-11 - 2.40022985e-12j,
                 -3.73147944e-11 - 1.17403240e-12j,
                 -1.93078981e-11 - 5.08300528e-13j,
                 -1.14349424e-11 - 1.12890694e-13j,
                 -7.39441008e-12 + 1.31154315e-13j,
                 -5.07517340e-12 + 2.82400041e-13j,
                 -3.63112052e-12 + 3.73402277e-13j,
                 -2.67525131e-12 + 4.23887090e-13j],
                [-7.58384209e-09 - 1.68838485e-11j,
                 -7.55497304e-10 - 5.46728225e-12j,
                 -1.63022288e-10 - 2.43226347e-12j,
                 -5.64902062e-11 - 1.01060604e-12j,
                 -2.63209545e-11 - 2.33028588e-13j,
                 -1.46491239e-11 + 2.15863749e-13j,
                 -9.08813884e-12 + 4.76232699e-13j,
                 -6.04179032e-12 + 6.20749665e-13j,
                 -4.20324780e-12 + 6.91097290e-13j,
                 -3.01362555e-12 + 7.12990606e-13j,
                 -1.33661347e-09 - 1.92526232e-11j,
                 -2.96267781e-10 - 6.23337683e-12j,
                 -9.00067913e-11 - 2.68222730e-12j,
                 -3.78366147e-11 - 1.12832592e-12j,
                 -1.96870142e-11 - 3.09760035e-13j,
                 -1.16966690e-11 + 1.54884606e-13j,
                 -7.56081348e-12 + 4.22870372e-13j,
                 -5.16538338e-12 + 5.72089126e-13j,
                 -3.66158984e-12 + 6.46045390e-13j,
                 -2.65999513e-12 + 6.71142568e-13j],
                [-7.58558415e-09 - 2.12614539e-11j,
                 -7.56821811e-10 - 6.40396355e-12j,
                 -1.64001127e-10 - 2.51253899e-12j,
                 -5.71874126e-11 - 7.39748909e-13j,
                 -2.67915439e-11 + 1.87055261e-13j,
                 -1.49401021e-11 + 6.84859208e-13j,
                 -9.23944332e-12 + 9.40367809e-13j,
                 -6.08704725e-12 + 1.05097576e-12j,
                 -4.17043787e-12 + 1.07266794e-12j,
                 -2.92571096e-12 + 1.03983712e-12j,
                 -1.33826084e-09 - 2.43646830e-11j,
                 -2.97516543e-10 - 7.41950303e-12j,
                 -9.09256562e-11 - 2.85702886e-12j,
                 -3.84870115e-11 - 9.12769542e-13j,
                 -2.01218296e-11 + 6.76140970e-14j,
                 -1.19611138e-11 + 5.86953380e-13j,
                 -7.69326021e-12 + 8.53986769e-13j,
                 -5.19807614e-12 + 9.72688187e-13j,
                 -3.62129047e-12 + 1.00123509e-12j,
                 -2.56860034e-12 + 9.74776715e-13j],
                [-7.58810954e-09 - 2.65940057e-11j,
                 -7.58657499e-10 - 7.28832807e-12j,
                 -1.65281948e-10 - 2.33862080e-12j,
                 -5.80316932e-11 - 1.72658762e-13j,
                 -2.72989372e-11 + 8.84998136e-13j,
                 -1.51934883e-11 + 1.38828726e-12j,
                 -9.30693415e-12 + 1.58717328e-12j,
                 -6.02378421e-12 + 1.61246540e-12j,
                 -4.02026870e-12 + 1.53898172e-12j,
                 -2.72278018e-12 + 1.41193952e-12j,
                 -1.34062892e-09 - 3.06652358e-11j,
                 -2.99230164e-10 - 8.64243523e-12j,
                 -9.21135259e-11 - 2.82084491e-12j,
                 -3.92622251e-11 - 4.31954261e-13j,
                 -2.05796506e-11 + 6.97060774e-13j,
                 -1.21806916e-11 + 1.23140712e-12j,
                 -7.73949050e-12 + 1.44917625e-12j,
                 -5.12332991e-12 + 1.48928041e-12j,
                 -3.46705403e-12 + 1.42904379e-12j,
                 -2.36703705e-12 + 1.31442255e-12j],
                [-7.59175205e-09 - 3.29893677e-11j,
                 -7.61167080e-10 - 7.95897230e-12j,
                 -1.66910887e-10 - 1.73490186e-12j,
                 -5.89969126e-11 + 8.32437012e-13j,
                 -2.77782461e-11 + 1.95674181e-12j,
                 -1.53296363e-11 + 2.37777528e-12j,
                 -9.21227307e-12 + 2.43125689e-12j,
                 -5.78472462e-12 + 2.29212007e-12j,
                 -3.70148049e-12 + 2.05854724e-12j,
                 -2.37108896e-12 + 1.78766395e-12j,
                 -1.34401127e-09 - 3.83413924e-11j,
                 -3.01545134e-10 - 9.77841179e-12j,
                 -9.36012788e-11 - 2.42169509e-12j,
                 -4.01290001e-11 + 4.37490153e-13j,
                 -2.09941727e-11 + 1.65992270e-12j,
                 -1.22780425e-11 + 2.12882918e-12j,
                 -7.62557341e-12 + 2.21531659e-12j,
                 -4.87920504e-12 + 2.10396103e-12j,
                 -3.15304054e-12 + 1.89559987e-12j,
                 -2.02650730e-12 + 1.64795412e-12j],
                [-7.59697497e-09 - 4.05030864e-11j,
                 -7.64541182e-10 - 8.15176683e-12j,
                 -1.68906322e-10 - 4.53343335e-13j,
                 -6.00071156e-11 + 2.45078031e-12j,
                 -2.81143907e-11 + 3.49874748e-12j,
                 -1.52303346e-11 + 3.68300512e-12j,
                 -8.85503925e-12 + 3.45352986e-12j,
                 -5.29706517e-12 + 3.04035801e-12j,
                 -3.17110382e-12 + 2.56707258e-12j,
                 -1.85495797e-12 + 2.10019517e-12j,
                 -1.34880625e-09 - 4.75588245e-11j,
                 -3.04613011e-10 - 1.06202839e-11j,
                 -9.53876699e-11 - 1.44897040e-12j,
                 -4.10052841e-11 + 1.84252168e-12j,
                 -2.12528070e-11 + 3.03183082e-12j,
                 -1.21421908e-11 + 3.29483967e-12j,
                 -7.26026309e-12 + 3.12511074e-12j,
                 -4.40211228e-12 + 2.76363715e-12j,
                 -2.64437476e-12 + 2.33656970e-12j,
                 -1.53771642e-12 + 1.91083155e-12j],
                [-7.60441275e-09 - 4.90855619e-11j,
                 -7.68985152e-10 - 7.45632690e-12j,
                 -1.71227564e-10 + 1.83884936e-12j,
                 -6.09092846e-11 + 4.87897112e-12j,
                 -2.81287572e-11 + 5.58337962e-12j,
                 -1.47407222e-11 + 5.28545528e-12j,
                 -8.12647691e-12 + 4.58078548e-12j,
                 -4.50273642e-12 + 3.76025533e-12j,
                 -2.41595408e-12 + 2.96675671e-12j,
                 -1.19534336e-12 + 2.26541935e-12j,
                 -1.35554451e-09 - 5.84237663e-11j,
                 -3.08582818e-10 - 1.08451448e-11j,
                 -9.74094553e-11 + 3.71609734e-13j,
                 -4.17369940e-11 + 3.93804139e-12j,
                 -2.11876508e-11 + 4.85766883e-12j,
                 -1.16337888e-11 + 4.69551593e-12j,
                 -6.55057347e-12 + 4.09938151e-12j,
                 -3.64741375e-12 + 3.37204387e-12j,
                 -1.93780845e-12 + 2.65888152e-12j,
                 -9.27871502e-13 + 2.02565123e-12j],
                [-7.61492001e-09 - 5.84993466e-11j,
                 -7.74688775e-10 - 5.26283558e-12j,
                 -1.73728544e-10 + 5.56127431e-12j,
                 -6.14437204e-11 + 8.30490501e-12j,
                 -2.75756265e-11 + 8.21956054e-12j,
                 -1.36874365e-11 + 7.08651335e-12j,
                 -6.93941056e-12 + 5.66964254e-12j,
                 -3.38986698e-12 + 4.30855172e-12j,
                 -1.47797993e-12 + 3.14094592e-12j,
                 -4.64870284e-13 + 2.20468896e-12j,
                 -1.36491694e-09 - 7.09237566e-11j,
                 -3.13566728e-10 - 9.97851860e-12j,
                 -9.94999639e-11 + 3.37031123e-12j,
                 -4.20758664e-11 + 6.85399169e-12j,
                 -2.05781819e-11 + 7.11425209e-12j,
                 -1.06067207e-11 + 6.21997667e-12j,
                 -5.43223489e-12 + 4.99589272e-12j,
                 -2.61921546e-12 + 3.79469380e-12j,
                 -1.08416103e-12 + 2.75776097e-12j,
                 -2.72484989e-13 + 1.92565035e-12j],
                [-7.62962513e-09 - 6.81940145e-11j,
                 -7.81769378e-10 - 7.03228157e-13j,
                 -1.76096408e-10 + 1.12008066e-11j,
                 -6.12215596e-11 + 1.28526627e-11j,
                 -2.61605936e-11 + 1.13008767e-11j,
                 -1.19209963e-11 + 8.88002217e-12j,
                 -5.27457187e-12 + 6.50795315e-12j,
                 -2.02819428e-12 + 4.51950118e-12j,
                 -4.71537103e-13 + 2.98953430e-12j,
                 +2.13511377e-13 + 1.88110223e-12j,
                 -1.37779730e-09 - 8.48399697e-11j,
                 -3.19581863e-10 - 7.36172268e-12j,
                 -1.01338862e-10 + 7.90243615e-12j,
                 -4.16689883e-11 + 1.06405593e-11j,
                 -1.91769835e-11 + 9.66520261e-12j,
                 -8.95202165e-12 + 7.66124665e-12j,
                 -3.91315320e-12 + 5.61740017e-12j,
                 -1.40067198e-12 + 3.88629454e-12j,
                 -2.00214734e-13 + 2.55260103e-12j,
                 +3.10293059e-13 + 1.58911949e-12j],
                [-7.64998090e-09 - 7.71226491e-11j,
                 -7.90177031e-10 + 7.40324770e-12j,
                 -1.77781306e-10 + 1.92552733e-11j,
                 -5.97267058e-11 + 1.84994402e-11j,
                 -2.35950926e-11 + 1.45530442e-11j,
                 -9.38441555e-12 + 1.03481925e-11j,
                 -3.23265021e-12 + 6.84964128e-12j,
                 -5.90396777e-13 + 4.25790729e-12j,
                 +4.25585901e-13 + 2.48025076e-12j,
                 +6.96741941e-13 + 1.33582599e-12j,
                 -1.39524984e-09 - 9.96237972e-11j,
                 -3.26461703e-10 - 2.13506963e-12j,
                 -1.02403132e-10 + 1.42817518e-11j,
                 -4.00770807e-11 + 1.51928232e-11j,
                 -1.67695413e-11 + 1.22223506e-11j,
                 -6.66248078e-12 + 8.72395241e-12j,
                 -2.11683606e-12 + 5.75244432e-12j,
                 -1.66416983e-13 + 3.54384446e-12j,
                 +5.46740069e-13 + 2.03424094e-12j,
                 +6.92971925e-13 + 1.06993787e-12j],
                [-7.67779820e-09 - 8.34808167e-11j,
                 -7.99551278e-10 + 2.05810341e-11j,
                 -1.77934893e-10 + 3.01241065e-11j,
                 -5.63665616e-11 + 2.49730414e-11j,
                 -1.96955142e-11 + 1.75066266e-11j,
                 -6.19480324e-12 + 1.11053415e-11j,
                 -1.06583628e-12 + 6.49205785e-12j,
                 +6.66297337e-13 + 3.49197042e-12j,
                 +1.02205836e-12 + 1.69368955e-12j,
                 +8.80509995e-13 + 6.98866512e-13j,
                 -1.41850579e-09 - 1.14231896e-10j,
                 -3.33734968e-10 + 6.74264552e-12j,
                 -1.01940319e-10 + 2.26685940e-11j,
                 -3.68424478e-11 + 2.01690821e-11j,
                 -1.32704683e-11 + 1.43401811e-11j,
                 -3.90040482e-12 + 9.07954063e-12j,
                 -2.99026122e-13 + 5.25274857e-12j,
                 +8.45859807e-13 + 2.77204502e-12j,
                 +9.92260964e-13 + 1.30006176e-12j,
                 +7.95596617e-13 + 4.99669892e-13j],
                [-7.71523809e-09 - 8.43468544e-11j,
                 -8.09024599e-10 + 4.06751086e-11j,
                 -1.75390669e-10 + 4.39363213e-11j,
                 -5.05960916e-11 + 3.16588112e-11j,
                 -1.45163815e-11 + 1.95332670e-11j,
                 -2.70166717e-12 + 1.08063417e-11j,
                 +8.48160416e-13 + 5.38220202e-12j,
                 +1.47634028e-12 + 2.35221415e-12j,
                 +1.19730622e-12 + 8.25988431e-13j,
                 +7.61683396e-13 + 1.50191647e-13j,
                 -1.44888584e-09 - 1.26918459e-10j,
                 -3.40480259e-10 + 2.04102631e-11j,
                 -9.89977121e-11 + 3.29145268e-11j,
                 -3.16219045e-11 + 2.49366167e-11j,
                 -8.83720093e-12 + 1.54769903e-11j,
                 -1.03055624e-12 + 8.47728992e-12j,
                 +1.19498276e-12 + 4.12702142e-12j,
                 +1.41586246e-12 + 1.72563338e-12j,
                 +1.05374136e-12 + 5.43559890e-13j,
                 +6.38458762e-13 + 4.21606591e-14j],
                [-7.76472191e-09 - 7.52028990e-11j,
                 -8.16981969e-10 + 6.97310714e-11j,
                 -1.68734736e-10 + 6.03260988e-11j,
                 -4.21231754e-11 + 3.75703922e-11j,
                 -8.47339625e-12 + 1.99812613e-11j,
                 +5.33054616e-13 + 9.30621832e-12j,
                 +2.11564884e-12 + 3.70333887e-12j,
                 +1.68580459e-12 + 1.12595792e-12j,
                 +9.79219738e-13 + 1.21701777e-13j,
                 +4.58479121e-13 - 1.65529182e-13j,
                 -1.48763729e-09 - 1.34992467e-10j,
                 -3.45183328e-10 + 3.99245777e-11j,
                 -9.25485761e-11 + 4.43899506e-11j,
                 -2.43765942e-11 + 2.85978923e-11j,
                 -3.95078044e-12 + 1.51452322e-11j,
                 +1.43038885e-12 + 6.88593404e-12j,
                 +2.04692342e-12 + 2.60006672e-12j,
                 +1.45021624e-12 + 6.83536546e-13j,
                 +7.91342315e-13 - 2.03622067e-14j,
                 +3.47684739e-13 - 1.88663130e-13j],
                [-7.82869745e-09 - 4.93216426e-11j,
                 -8.20811001e-10 + 1.09729186e-10j,
                 -1.56520117e-10 + 7.82032133e-11j,
                 -3.11614964e-11 + 4.14551831e-11j,
                 -2.37618944e-12 + 1.84123667e-11j,
                 +2.87857510e-12 + 6.80667209e-12j,
                 +2.50015470e-12 + 1.86974601e-12j,
                 +1.35440691e-12 + 1.54086682e-13j,
                 +5.52752838e-13 - 2.47038164e-13j,
                 +1.53984934e-13 - 2.22561884e-13j,
                 -1.53564765e-09 - 1.34562531e-10j,
                 -3.45649732e-10 + 6.59616322e-11j,
                 -8.17465456e-11 + 5.58575288e-11j,
                 -1.55660138e-11 + 3.01523914e-11j,
                 +6.11213129e-13 + 1.31314601e-11j,
                 +2.97483967e-12 + 4.59518772e-12j,
                 +2.12177006e-12 + 1.07390898e-12j,
                 +1.05664492e-12 - 6.40455452e-14j,
                 +3.95066694e-13 - 2.67640235e-13j,
                 +8.96616860e-14 - 1.96515915e-13j],
                [-7.90916819e-09 + 2.98203650e-12j,
                 -8.16712675e-10 + 1.62130317e-10j,
                 -1.37654445e-10 + 9.56143398e-11j,
                 -1.86344016e-11 + 4.20875804e-11j,
                 +2.71620231e-12 + 1.48709293e-11j,
                 +3.88810450e-12 + 3.88377452e-12j,
                 +2.07220316e-12 + 3.81539822e-13j,
                 +7.54141247e-13 - 3.38964328e-13j,
                 +1.64682699e-13 - 2.80592434e-13j,
                 -1.51474569e-14 - 1.25564808e-13j,
                 -1.59299187e-09 - 1.20313720e-10j,
                 -3.39052580e-10 + 9.84039013e-11j,
                 -6.62974592e-11 + 6.54900953e-11j,
                 -6.24096556e-12 + 2.88113802e-11j,
                 +3.97014740e-12 + 9.69807931e-12j,
                 +3.33602780e-12 + 2.18314211e-12j,
                 +1.57198888e-12 - 3.37954344e-14j,
                 +5.09777850e-13 - 3.68970197e-13j,
                 +8.01059158e-14 - 2.38516359e-13j,
                 -3.22642458e-14 - 9.39502563e-14j],
                [-8.00684981e-09 + 9.52062203e-11j,
                 -7.99681266e-10 + 2.27222829e-10j,
                 -1.11923888e-10 + 1.09829970e-10j,
                 -6.17969454e-12 + 3.87264653e-11j,
                 +5.84309694e-12 + 1.00372026e-11j,
                 +3.54871844e-12 + 1.31119861e-12j,
                 +1.21422529e-12 - 4.18715187e-13j,
                 +2.25954933e-13 - 3.73780753e-13j,
                 -2.75545535e-14 - 1.41182458e-13j,
                 -3.89939789e-14 - 2.23178337e-14j,
                 -1.65827149e-09 - 8.53901509e-11j,
                 -3.22207911e-10 + 1.35871450e-10j,
                 -4.68592478e-11 + 7.11379649e-11j,
                 +2.09188111e-12 + 2.43931625e-11j,
                 +5.49012343e-12 + 5.62472537e-12j,
                 +2.66555701e-12 + 3.00821482e-13j,
                 +7.88328364e-13 - 5.06835422e-13j,
                 +9.68487458e-14 - 3.10600129e-13j,
                 -4.66244654e-14 - 9.88269136e-14j,
                 -3.38947968e-14 - 9.15648941e-15j],
                [-8.11975846e-09 + 2.45538487e-10j,
                 -7.63787855e-10 + 3.03319990e-10j,
                 -8.05082169e-11 + 1.17779778e-10j,
                 +4.18070912e-12 + 3.15831203e-11j,
                 +6.58310694e-12 + 5.09909966e-12j,
                 +2.34888146e-12 - 2.90669331e-13j,
                 +4.22628799e-13 - 5.36717413e-13j,
                 -2.76498850e-14 - 1.84794577e-13j,
                 -4.06146107e-14 - 1.87036859e-14j,
                 -4.77930225e-15 + 1.15423090e-14j,
                 -1.72771129e-09 - 2.14959287e-11j,
                 -2.92147330e-10 + 1.75326471e-10j,
                 -2.52873871e-11 + 7.08894920e-11j,
                 +7.89977821e-12 + 1.76130947e-11j,
                 +5.12027392e-12 + 1.97475678e-12j,
                 +1.50331655e-12 - 6.49386632e-13j,
                 +1.82295043e-13 - 4.51427491e-13j,
                 -5.80808650e-14 - 1.23392319e-13j,
                 -3.37586746e-14 - 4.11459739e-15j,
                 -1.39510432e-15 + 1.01749613e-14j],
                [-8.24095448e-09 + 4.77556248e-10j,
                 -7.02894095e-10 + 3.85939795e-10j,
                 -4.62348108e-11 + 1.16854522e-10j,
                 +1.07070812e-11 + 2.20276813e-11j,
                 +5.33628799e-12 + 1.29328755e-12j,
                 +1.04463692e-12 - 7.84366530e-13j,
                 +1.07415412e-14 - 2.94955629e-13j,
                 -4.39685079e-14 - 2.72527508e-14j,
                 +1.85948210e-15 + 1.13204056e-14j,
                 +1.12837457e-14 + 9.52552274e-17j,
                 -1.79399645e-09 + 8.06177987e-11j,
                 -2.46980397e-10 + 2.11943110e-10j,
                 -4.49776808e-12 + 6.38215897e-11j,
                 +1.02467988e-11 + 1.00297072e-11j,
                 +3.49722299e-12 - 3.75046264e-13j,
                 +4.90108659e-13 - 7.32966240e-13j,
                 -6.17567398e-14 - 1.96244995e-13j,
                 -3.72593630e-14 - 6.69673799e-15j,
                 +3.72947422e-15 + 8.74021793e-15j,
                 +8.22362755e-15 - 1.86306161e-15j]])

# 6. TIME; SIGNAL = 0
inp6 = {'fEM': fEM, 'off': off, 'freq': freq, 'time': np.array([1., 2., 3.]),
        'signal': 0, 'ft': 'fftlog', 'ftarg': ftarg}
EM6, _ = tem(**inp6)

# 7. TIME; SIGNAL = 1
inp7 = deepcopy(inp6)
inp7['signal'] = 1
EM7, _ = tem(**inp7)

# 8. TIME; SIGNAL = -1
inp8 = deepcopy(inp6)
inp8['signal'] = -1
EM8, _ = tem(**inp8)

# Store data
np.savez_compressed('../data_fem_tem.npz',
                    out1={'inp': inp1, 'EM': EM1, 'kcount': kcount1},
                    out2={'inp': inp2, 'EM': EM2, 'kcount': kcount2},
                    out3={'inp': inp3, 'EM': EM3, 'kcount': kcount3},
                    out4={'inp': inp4, 'EM': EM4, 'kcount': kcount4},
                    out5={'inp': inp5, 'EM': EM5, 'kcount': kcount5},
                    out6={'inp': inp6, 'EM': EM6},
                    out7={'inp': inp7, 'EM': EM7},
                    out8={'inp': inp8, 'EM': EM8})
